package api;

import org.json.*;
import org.restlet.representation.*;
import org.restlet.ext.json.*;
import org.restlet.resource.*;
import gameServer.GameMachine;


public class GameServerResource extends ServerResource {

	GameMachine machine = GameMachine.getInstance();

//	@Get
//	public Representation get() throws JSONException {
//
//		String banner = machine.toString();
//		int count = machine.getCount();
//		String state = machine.getStateString();
//
//		JSONObject json = new JSONObject();
//		json.put("banner", banner);
//		json.put("count", count);
//		json.put("state", state);
//
//		return new JsonRepresentation(json);
//	}

	@Post
	public Representation post(JsonRepresentation jsonRep) {

		JSONObject json = jsonRep.getJsonObject();
		String action = json.getString("action");
		System.out.println("action: " + action);

		if (action.equals("registerPlayer"))
			machine.registerPlayer();
		if (action.equals("setLevel"))
			machine.setLevel();
		if (action.equals("setScore"))
			machine.setScore();
		if (action.equals("getHighScore"))
			machine.getHighScore();

		JSONObject response = new JSONObject();
		String state = machine.getStateString();
		response.put("result", state);

		return new JsonRepresentation(response);

	}
}
